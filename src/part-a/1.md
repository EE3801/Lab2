# Part 1. Install and test data analysis software

## 1.
Create a GitHub account [here](https://github.com) if you do not already have one.

## 2.
Fork the following [repository](https://github.com/shihchengyen/PyHipp) on GitHub, which you will be modifying in the next few weeks.

You can find instructions on how to fork a repository [here](https://guides.github.com/activities/forking/).

Once you have forked the repository, click on the Code button to reveal the link to your repository, and click on the copy link icon (highlighted in the red circle below).

![Alt text](GitCloneLink.png)

## 3.
Install VS Code on your computer from [here](https://code.visualstudio.com).

## 4.
After starting VS Code, select the "Clone Git Repository" option (highlighted in red below), which will create a text entry field in the title bar (as shown below). Paste the link to your repository there. You will then be asked to select a location on your computer to save the repository.

![Alt text](VSCodeCloneRepository.png)

> <p class="note"> Note
> 
> For different OS the relative file path might be different. We recommend to just create a folder that you will use for the rest of this course and clone all the necessary repository inside them for ease of management. 
>
> **Avoid** folder names with space (eg. `Documents/EE3801 Lab Work`) unless you know what you are doing and are familiar with how path syntax work in CLI.

## 5.
Next, assuming you have either Miniconda or Anaconda installed, use a Terminal window to create the “aws” conda environment with Python version 3.8.

> <p class="warn"> Warning
>
> *For MacOS M1 / M2 user, IMPORTANT*
>
> From this section onward, there is a few thing that you need to make sure of:
> 1. Make sure your terminal is running on `arch = i386` or the Rosetta 2 translation layer for M1/M2. To do this, first, open up your `Finder` -> `Applications`, right click on your choice of terminal <br/>
> *\*in this example, `Terminal` was used, it is under the `Utilities` folder* <br/> 
> *\*if you are using other terminal, such as Alacritty, the process is the same* <br/>
> ![Alt text](image-3.png) <br/><br/>
> Then, you should see something like this <br/>
> ![Alt text](image-4.png) <br/>
> select `Open using Rosetta`. Afterward, open up your terminal and type in this command `arch` and if you see `i386` you are good to go. 
> 2. Then make sure you install the `Intel x86_64` (https://repo.anaconda.com/miniconda/Miniconda3-latest-MacOSX-x86_64.sh) version of Miniconda or Anaconda *NOT* the `Apple M1` version. This is because some packages rely on Cython to compile correctly to run (eg. pyedfread, ...), so the `Apply M1` version will not work (in general however, outside of this course, you should use the `Apple M1` version for best performance).
> 3. If you still have problem, please approach a GA for help to resolve your issue.

> <p class="note">Note
> 
> Windows users should enter the commands below using the Anaconda Prompt

![Alt text](image-7.png)

```shell
(base) 
$ conda create -n aws python=3.8 -y

(base) 
$ conda activate aws
```

The symbol below

```shell
(base) 
$ 

(aws) 
$ 
```
indicates your command prompt, so you do not need to type them. In another word, when you see

```shell
(base) 
$ conda activate aws
```
only copy the command-line.

```bash
conda activate aws
```

## 6.
Install software for reading the eye-tracker data files, which may require Administrator privileges:

> #### macOS:
> Install the Xcode command line tools:
>
> ```shell
> (aws) 
> $ xcode-select --install
> ```
> Download and install the [Eyelink Installer](https://www.icloud.com/iclouddrive/06bafrFQFcoyve64IWZjMvjjw#EyelinkDisplayAPI_1.11.1).
>
> Right click and select “Open” from the drop-down menu in order to run the installer. Do not change the default installation location. After installation, check that the folder `/Applications/Eyelink` is present.

> #### Windows:
> [Visual Studio](https://visualstudio.microsoft.com/downloads):
> use Build tool to install “Desktop development with C++.
>
>[Eyelink Installer](https://www.icloud.com/iclouddrive/03fVwOPcA9VK0RinNuC4DlhRA#EyeLinkDevKit_Windows_1.11):
> make sure you choose the “C” drive for installation. After installation, check that the folder `C:\Program Files (x86)\SR Research\EyeLink\EDF_Access_API` is present.

> #### Linux
> Download [Eyelink Installer](https://www.icloud.com/iclouddrive/0f6gouqAVEEuR7j4oMkZm8uOQ#eyelink-display-software_1)
> 
> Then run the following in your cli
> ```shell
> $ tar -xvzf eyelink-display-software_1.11_x64_debs.tar.gz
> $ cd eyelink-display-software_1.11_x64
> $ sudo dpkg -i ./edfapi_4.0_amd64.deb
> ```

## 7.
Clone the following GitHub repositories onto your computer using GitHub Desktop to a directory like `Documents/EE3801`:

- [Data Processing Tools](https://github.com/grero/DataProcessingTools)
- [PanGUI](https://github.com/grero/PanGUI)
- [PyedFread](https://github.com/nwilming/pyedfread)

## 8.
Python usually uses a site-packages directory to store all installed packages and libraries. So when you install a module, you will typically do 

```shell
$ pip install .
```
which copies code to the site-packages directory (e.g. `~/anaconda3/lib/python3.8/site-packages/`). 

However, we will link the forked repository on your computer to the site-packages directory instead by doing 

```shell
$ pip install -e .
```

so that you can edit and test your code more quickly instead of having to install it into the site-packages directory each time you change some code 

```shell
(aws) 
$ cd ~/Documents/EE3801/DataProcessingTools

(aws) 
$ pip install -e .

(aws) 
$ cd ../PanGUI

(aws) 
$ pip install -e .

(aws) 
$ cd ../PyHipp

(aws) 
$ pip install -e .
```

> <p class="warn"> Warn
>
> Make sure that when you go up a directory with the command 
> ```shell
> $ cd ..
> ```
> your `PanGUI`, `PyHipp` and `pyedfread` folder must exist in the same folder as your DataProcessingTools. In the example below, that would be the `Documents/EE3801` or else your command will fail.

> <p class="note"> Note
>
> Replace the directory path below with the appropriate directory for your computer 

> <p class="note"> Note
>
> If you encounter an error with failing to install DataProcessingTools regarding a package call h5py 
> ```shell
> Error: Failed to install wheel for h5p5
> ```
> Then please do the following:
> 1. Go to the folder `Documents/EE3801/DataProcessingTools` and open up the file `setup.py`.
> 2. Locate the following line 
> ```python
>      install_requires=["numpy",
>                        "scipy",
>                        "matplotlib",
>                        "h5py < 3",
>                        "hickle",
>                        "pathlib"]
> ```
> change the `h5py < 3` to just `h5py` and then save it.
> 
> 3. Run the `pip install -e .` command again.

## 9.
These modules depend on other modules being installed, so we will need to install those modules as well. In the same `Documents/EE3801/PyHipp` folder:

```shell
(aws) 
$ pip install -r requirements.txt
```

## 10.
As the pyedfread module is from a third-party, and we are unlikely to modify it, we can just install it normally:

> <p class="note"> Note
> 
> Windows users need to switch to an Administrator user and edit the file edftypes.h (in C:\Program Files (x86)\SR Research\EyeLink\EDF_Access_API\Example) before running the command below. Replace Lines 15–25 with the following lines:
> ```bash
> #ifndef BYTEDEF
>	  #define BYTEDEF 1
>	  typedef unsigned char  byte;
>	  #ifndef _BASETSD_H_ /* windows header */
>		  typedef short          INT16;
>		  typedef int            INT32;
>		  typedef unsigned short UINT16;
>		  typedef unsigned int   UINT32;
>	  #endif
> #endif
> ```

```shell
(aws) 
$ cd ../pyedfread

(aws) 
$ pip install .

(aws) 
$ cd ..
```

> <p class="note"> Note
>
> You can also try installing by linking instead:
> ```shell
> (aws) 
> $ pip install -e .
> ```

## 11.
If you installed Miniconda instead of Anaconda and have not installed Spyder, you will have to install Spyder using:

```shell
(aws) 
$ conda install spyder
```

> <p class="note"> Note
>
> If you get the following error:
>
> ```shell
> qtpy.QtModuleNotInstalledError: The QtWebEngineWidgets module was not found. It must be installed separately as PyQtWebEngine.
> ```
>
> you can do the following:
> ```shell
> (aws) 
> $ conda install PyQtWebEngine
> ```

which should allow Spyder to work properly.

## 12.
Launch Spyder and test to make sure everything is installed and working properly:

```shell
(aws)
$ cd

(aws) 
$ spyder
```

Make sure the default working directory is set to the current working directory in the “Run” and “Current working directory” sections in the Preferences window (click the  icon in the toolbar):

![Alt text](image-8.png)

![Alt text](image-9.png)

Also, in the “iPython console” section, choose the “Graphics” tab, and make sure the “Graphics backend” setting is set to “Automatic”:

![Alt text](image-10.png)

To easily find and access all of your `.py` file created using Spyder, you can change your working directory of Spyder on the top right corner to your EE3801 lab directory.

![Alt text](image-1.png)

Over here the path should be something like the following in your spyder:

`Users/user-name/Documents/EE3801/untitled.py`

![Alt text](image-2.png)

*\*ignore the path in the image, it is just for illustration purposes*

Now, everytime you save the script, it will be saved to your working directory.

## 13.
Do the following to test the PyHipp and DataProcessingTools modules:

```shell
In[ ]: import PyHipp as pyh
In[ ]: pyh.pyhcheck('hello')
hello
```

Note that commands preceded by `In[ ]:` means you should be typing the commands in the Python console.

## 14.
Do the following to test the PanGUI module:

```shell
In[ ]: import PanGUI
In[ ]: PanGUI.test()
```

This should create a window that looks like the following:

![Alt text](image-11.png)

> <p class="task"> Task
>
> Include a screenshot of the window in your lab report. 

After that, you can close the plot window.

## 15.
Test your pyedfread setup (replace the pyedfread directory below with the appropriate directory on your computer, and make sure you are NOT in the pyedfread directory when you perform the first command below):

```shell
In[ ]: from pyedfread import edf
In[ ]: cd ~/Documents/Python/pyedfread
In[ ]: samples, events, messages = edf.pread('SUB001.EDF')
In[ ]: events.shape
(485, 30)
```

> <p class="task"> Task
>
> Include a screenshot of the window in your lab report. 